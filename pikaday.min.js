/*!
 * Pikaday
 * Copyright Â© 2012 David Bushell | BSD & MIT license | http://dbushell.com/
 */
(function(g,r,p){var s="function"===typeof g.moment,t=!!g.addEventListener,u=g.setTimeout,k=function(a,b,c,d){t?a.addEventListener(b,c,!!d):a.attachEvent("on"+b,c)},q=function(a,b,c,d){t?a.removeEventListener(b,c,!!d):a.detachEvent("on"+b,c)},h=function(a,b){return-1!==(" "+a.className+" ").indexOf(" "+b+" ")},v=function(a){return/Array/.test(Object.prototype.toString.call(a))},j=function(a){return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},w=function(a,b,c){var d,e;for(d in b)if((e=
a[d]!==p)&&"object"===typeof b[d]&&b[d].nodeName===p)j(b[d])?c&&(a[d]=new Date(b[d].getTime())):v(b[d])?c&&(a[d]=b[d].slice(0)):a[d]=w({},b[d],c);else if(c||!e)a[d]=b[d];return a},z=Array.prototype.indexOf||function(a){for(var b=this.length;-1<--b;)if(this[b]==a)return b;return-1},x={field:null,bound:p,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,disabledDates:[],minYear:0,maxYear:9999,minMonth:p,maxMonth:p,isRTL:!1,numberOfMonths:1,i18n:{months:"January February March April May June July August September October November December".split(" "),
weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" ")},onSelect:null,onOpen:null,onClose:null},y=function(a,b,c){for(b+=a.firstDay;7<=b;)b-=7;return c?a.i18n.weekdaysShort[b]:a.i18n.weekdays[b]},A=function(a,b,c,d,e){if(e)return'<td class="is-empty"></td>';e=[];d&&e.push("is-disabled");c&&e.push("is-today");b&&e.push("is-selected");return'<td data-day="'+a+'" class="'+e.join(" ")+'"><button class="pika-button" type="button">'+
a+"</button></td>"};g.Pikaday=function(a){var b=this,c=b.config(a);b._onMouseDown=function(a){if(b._v){a=a||g.event;var e=a.target||a.srcElement;if(e){if(!h(e,"is-disabled")){if(h(e,"pika-button")&&!h(e,"is-empty")){b.setDate(new Date(b._y,b._m,parseInt(e.innerHTML,10)));c.bound&&u(function(){b.hide()},100);return}h(e,"pika-prev")?b.prevMonth():h(e,"pika-next")&&b.nextMonth()}if(h(e,"pika-select"))b._c=!0;else if(a.preventDefault)a.preventDefault();else return a.returnValue=!1}}};b._onChange=function(a){a=
a||g.event;(a=a.target||a.srcElement)&&(h(a,"pika-select-month")?b.gotoMonth(a.value):h(a,"pika-select-year")&&b.gotoYear(a.value))};b._onInputChange=function(){if(s)b.setDate(g.moment(c.field.value,c.format).toDate());else{var a=new Date(Date.parse(c.field.value));b.setDate(j(a)?a:null)}b._v||b.show()};b._onInputFocus=function(){b.show()};b._onInputClick=function(){b.show()};b._onInputBlur=function(){b._c||(b._b=u(function(){b.hide()},50));b._c=!1};b._onClick=function(a){a=a||g.event;var e=a=a.target||
a.srcElement;if(a){!t&&h(a,"pika-select")&&!a.onchange&&(a.setAttribute("onchange","return;"),k(a,"change",b._onChange));do if(h(e,"pika-single"))return;while(e=e.parentNode);b._v&&a!==c.field&&b.hide()}};b.el=r.createElement("div");b.el.className="pika-single"+(c.isRTL?" is-rtl":"");k(b.el,"mousedown",b._onMouseDown,!0);k(b.el,"change",b._onChange);c.field&&(c.bound?r.body.appendChild(b.el):c.field.parentNode.insertBefore(b.el,c.field.nextSibling),k(c.field,"change",b._onInputChange),c.defaultDate||
(c.defaultDate=s&&c.field.value?g.moment(c.field.value,c.format).toDate():new Date(Date.parse(c.field.value)),c.setDefaultDate=!0));a=c.defaultDate;j(a)?c.setDefaultDate?b.setDate(a):b.gotoDate(a):b.gotoDate(new Date);c.bound?(this.hide(),b.el.className+=" is-bound",k(c.field,"click",b._onInputClick),k(c.field,"focus",b._onInputFocus),k(c.field,"blur",b._onInputBlur)):this.show()};g.Pikaday.prototype={config:function(a){this._o||(this._o=w({},x,!0));a=w(this._o,a,!0);a.isRTL=!!a.isRTL;a.field=a.field&&
a.field.nodeName?a.field:null;a.bound=!!(a.bound!==p?a.field&&a.bound:a.field);var b=parseInt(a.numberOfMonths,10)||1;a.numberOfMonths=4<b?4:b;j(a.minDate)||(a.minDate=!1);j(a.maxDate)||(a.maxDate=!1);a.minDate&&a.maxDate&&a.maxDate<a.minDate&&(a.maxDate=a.minDate=!1);a.minDate&&(a.minYear=a.minDate.getFullYear(),a.minMonth=a.minDate.getMonth());a.maxDate&&(a.maxYear=a.maxDate.getFullYear(),a.maxMonth=a.maxDate.getMonth());v(a.yearRange)?(b=(new Date).getFullYear()-10,a.yearRange[0]=parseInt(a.yearRange[0],
10)||b,a.yearRange[1]=parseInt(a.yearRange[1],10)||b):(a.yearRange=Math.abs(parseInt(a.yearRange,10))||x.yearRange,100<a.yearRange&&(a.yearRange=100));return a},toString:function(a){return!j(this._d)?"":s?g.moment(this._d).format(a||this._o.format):this._d.toDateString()},getMoment:function(){return s?g.moment(this._d):null},getDate:function(){return j(this._d)?new Date(this._d.getTime()):null},setDate:function(a){if(!a)return this._d=null,this.draw();"string"===typeof a&&(a=new Date(Date.parse(a)));
if(j(a)){var b=this._o.minDate,c=this._o.maxDate;j(b)&&a<b?a=b:j(c)&&a>c&&(a=c);this._d=new Date(a.getTime());this._d.setHours(0,0,0,0);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString());"function"===typeof this._o.onSelect&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(a){j(a)&&(this._y=a.getFullYear(),this._m=a.getMonth(),this.draw())},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(a){if(!isNaN(a=parseInt(a,10)))this._m=0>a?0:11<a?11:a,
this.draw()},nextMonth:function(){11<++this._m&&(this._m=0,this._y++);this.draw()},prevMonth:function(){0>--this._m&&(this._m=11,this._y--);this.draw()},gotoYear:function(a){isNaN(a)||(this._y=parseInt(a,10),this.draw())},draw:function(a){if(this._v||a){var b=this._o;a=b.minYear;var c=b.maxYear,d=b.minMonth,e=b.maxMonth;this._y<=a&&(this._y=a,!isNaN(d)&&this._m<d&&(this._m=d));this._y>=c&&(this._y=c,!isNaN(e)&&this._m>e&&(this._m=e));a=this.el;for(var f=this._o,g=this._m,j=this._y,h=j===f.minYear,
l=j===f.maxYear,m='<div class="pika-title">',n=!0,k=!0,e=[],c=0;12>c;c++)e.push('<option value="'+c+'"'+(c===g?" selected":"")+(h&&c<f.minMonth||l&&c>f.maxMonth?"disabled":"")+">"+f.i18n.months[c]+"</option>");m+='<div class="pika-label">'+f.i18n.months[g]+'<select class="pika-select pika-select-month">'+e.join("")+"</select></div>";v(f.yearRange)?(c=f.yearRange[0],d=f.yearRange[1]+1):(c=j-f.yearRange,d=1+j+f.yearRange);for(e=[];c<d&&c<=f.maxYear;c++)c>=f.minYear&&e.push('<option value="'+c+'"'+(c===
j?" selected":"")+">"+c+"</option>");m+='<div class="pika-label">'+j+'<select class="pika-select pika-select-year">'+e.join("")+"</select></div>";if(h&&(0===g||f.minMonth>=g))n=!1;if(l&&(11===g||f.maxMonth<=g))k=!1;m=m+('<button class="pika-prev'+(n?"":" is-disabled")+'" type="button">Previous Month</button>')+('<button class="pika-next'+(k?"":" is-disabled")+'" type="button">Next Month</button>');a.innerHTML=m+"</div>"+this.render(this._y,this._m);if(b.bound){a=b.field;c=a.offsetLeft;for(d=a.offsetTop+
a.offsetHeight;a=a.offsetParent;)c+=a.offsetLeft,d+=a.offsetTop;this.el.style.cssText="position:absolute;left:"+c+"px;top:"+d+"px;";u(function(){b.field.focus()},1)}}},render:function(a,b){var c=this._o,d=new Date,e=[31,0===a%4&&0!==a%100||0===a%400?29:28,31,30,31,30,31,31,30,31,30,31][b],f=(new Date(a,b,1)).getDay(),g=[],h=[];d.setHours(0,0,0,0);0<c.firstDay&&(f-=c.firstDay,0>f&&(f+=7));for(var k=e+f,l=k;7<l;)l-=7;for(var k=k+(7-l),m=l=0;l<k;l++){var n=new Date(a,b,1+(l-f)),p=c.minDate&&n<c.minDate||
c.maxDate&&n>c.maxDate||0<=z.call(c.disabledDates,n.toString()),q=j(this._d)?n.getTime()===this._d.getTime():!1,n=n.getTime()===d.getTime();h.push(A(1+(l-f),q,n,p,l<f||l>=e+f));7===++m&&(g.push("<tr>"+(c.isRTL?h.reverse():h).join("")+"</tr>"),h=[],m=0)}e=[];for(d=0;7>d;d++)e.push('<th scope="col"><abbr title="'+y(c,d)+'">'+y(c,d,!0)+"</abbr></th>");return'<table cellpadding="0" cellspacing="0" class="pika-table">'+("<thead>"+(c.isRTL?e.reverse():e).join("")+"</thead>")+("<tbody>"+g.join("")+"</tbody>")+
"</table>"},isVisible:function(){return this._v},show:function(){if(!this._v){this._o.bound&&k(r,"click",this._onClick);var a=this.el,b;b=(" "+a.className+" ").replace(" is-hidden "," ");b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");a.className=b;this._v=!0;this.draw();"function"===typeof this._o.onOpen&&this._o.onOpen.call(this)}},hide:function(){var a=this._v;if(!1!==a){this._o.bound&&q(r,"click",this._onClick);this.el.style.cssText="";var b=this.el;h(b,"is-hidden")||(b.className=""===b.className?
"is-hidden":b.className+" is-hidden");this._v=!1;a!==p&&"function"===typeof this._o.onClose&&this._o.onClose.call(this)}},destroy:function(){this.hide();q(this.el,"mousedown",this._onMouseDown,!0);q(this.el,"change",this._onChange);this._o.field&&(q(this._o.field,"change",this._onInputChange),this._o.bound&&(q(this._o.field,"click",this._onInputClick),q(this._o.field,"focus",this._onInputFocus),q(this._o.field,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}})(window,
window.document);